<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="HaplinMethyl">
<title>Prepare data • HaplinMethyl</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare data">
<meta property="og:description" content="HaplinMethyl">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">HaplinMethyl</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jromanowska/HaplinMethyl">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Prepare data</h1>
                        <h4 data-toc-skip class="author">Julia
Romanowska</h4>
            
            <h4 data-toc-skip class="date">2024-01-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jromanowska/HaplinMethyl/blob/HEAD/vignettes/Prepare_data.Rmd" class="external-link"><code>vignettes/Prepare_data.Rmd</code></a></small>
      <div class="d-none name"><code>Prepare_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette will show you how to prepare the DNA methylation
dataset that you have read into the memory as shown in
<code>Read data</code> vignette. The preparation is necessary to use
this methylation data together with genetic data in interaction analyses
in <a href="https://cran.r-project.org/package=Haplin" class="external-link"><code>Haplin</code>
package</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jromanowska/HaplinMethyl/" class="external-link">HaplinMethyl</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: Haplin</span></span>
<span></span>
<span><span class="va">ex_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"HaplinMethyl"</span><span class="op">)</span></span>
<span><span class="va">ex_file</span> <span class="op">&lt;-</span> <span class="st">"env_data_test.dat"</span></span>
<span><span class="va">ex_out_file</span> <span class="op">&lt;-</span> <span class="st">"dnam_ex"</span></span>
<span></span>
<span><span class="va">dnam_ex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/envDataRead.html">envDataRead</a></span><span class="op">(</span></span>
<span>  file.in <span class="op">=</span> <span class="va">ex_file</span>,</span>
<span>  dir.in <span class="op">=</span> <span class="va">ex_path</span>,</span>
<span>  file.out <span class="op">=</span> <span class="va">ex_out_file</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">" "</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading the data in chunks...</span></span>
<span><span class="co">#&gt;  -- chunk 1--</span></span>
<span><span class="co">#&gt;  -- chunk 2--</span></span>
<span><span class="co">#&gt; ... done reading.</span></span>
<span><span class="co">#&gt; Preparing data...</span></span>
<span><span class="co">#&gt; ... done preparing</span></span>
<span><span class="co">#&gt; Saving data...</span></span>
<span><span class="co">#&gt; ... saved to file: ./dnam_ex_env.ffData</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="subsetting">Subsetting<a class="anchor" aria-label="anchor" href="#subsetting"></a>
</h2>
<p>Let’s check again what does <code>dnam_ex</code> object include:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dnam_ex</span></span>
<span><span class="co">#&gt; This is continuous environmental data read in by 'envDataRead'</span></span>
<span><span class="co">#&gt; with 400 columns</span></span>
<span><span class="co">#&gt; and 200 rows.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dnam_ex</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ class   : chr [1:2] "env.cont" "env.data"</span></span>
<span><span class="co">#&gt;  $ nrow    : int 200</span></span>
<span><span class="co">#&gt;  $ ncol    : int 400</span></span>
<span><span class="co">#&gt;  $ rownames: chr [1:200] "id1" "id2" "id3" "id4" ...</span></span>
<span><span class="co">#&gt;  $ colnames: chr [1:400] "cg1" "cg2" "cg3" "cg4" ...</span></span></code></pre></div>
<p>When you don’t want to use the entire data, you can use
<code>envDataSubset</code> function to easily specify which filters to
apply to the dataset.</p>
<p>You can subset using row names, row numbers, column names, or column
numbers. This is useful when you want to, e.g., extract only the
measurements from one subgroup of samples or focus on specific CpGs.</p>
<blockquote>
<p>Check the <code>Finding CpGs</code> vignette on how to use the
functions that find CpGs within a defined region!</p>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dnam_ex_3cpgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/envDataSubset.html">envDataSubset</a></span><span class="op">(</span></span>
<span>  env.data <span class="op">=</span> <span class="va">dnam_ex</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cg5"</span>, <span class="st">"cg7"</span>, <span class="st">"cg10"</span><span class="op">)</span>,</span>
<span>  file.out <span class="op">=</span> <span class="st">"dnam_ex_3cpgs"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Will select 3 columns.</span></span>
<span><span class="co">#&gt; opening ff /tmp/RtmpVechPi/ff/ff52eec5b90e4ba.ff</span></span>
<span><span class="co">#&gt; Saving data... </span></span>
<span><span class="co">#&gt; ... saved to files: ./dnam_ex_3cpgs_env.ffData, ./dnam_ex_3cpgs_env.RData</span></span></code></pre></div>
<p>This produces two new files: <code>dnam_ex_3cpgs_env.ffData</code>
and <code>dnam_ex_3cpgs_env.RData</code>, which again can be used to
load the data faster in the next R-session instance.</p>
<p>And the returned object is of the same class as the original one, but
has only the three chosen CpGs:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dnam_ex_3cpgs</span></span>
<span><span class="co">#&gt; This is continuous environmental data read in by 'envDataRead'</span></span>
<span><span class="co">#&gt; with 3 columns</span></span>
<span><span class="co">#&gt; and 200 rows.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dnam_ex_3cpgs</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ class   : chr [1:2] "env.cont" "env.data"</span></span>
<span><span class="co">#&gt;  $ nrow    : int 200</span></span>
<span><span class="co">#&gt;  $ ncol    : int 3</span></span>
<span><span class="co">#&gt;  $ rownames: chr [1:200] "id1" "id2" "id3" "id4" ...</span></span>
<span><span class="co">#&gt;  $ colnames: chr [1:3] "cg5" "cg7" "cg10"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="categorizing">Categorizing<a class="anchor" aria-label="anchor" href="#categorizing"></a>
</h2>
<p>When the measurements are continuous (as it is usually with data from
arrays), we need to first categorize it to use in <code>Haplin</code>.
Thus, the level of DNA methylation at a single CpG or a CpG region will
dictate the stratum membership for each sample.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dnam_ex_3cpgs_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/envDataCategorize.html">envDataCategorize</a></span><span class="op">(</span></span>
<span>  env.data <span class="op">=</span> <span class="va">dnam_ex_3cpgs</span>,</span>
<span>  breaks <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  file.out <span class="op">=</span> <span class="st">"dnam_ex_3cpg_cat"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; opening ff /tmp/RtmpVechPi/ff/ff52eec1dda0819.ff</span></span>
<span><span class="co">#&gt; Creating categories: 1,2,3</span></span>
<span><span class="co">#&gt; Saving data...</span></span>
<span><span class="co">#&gt; ... saved to file: ./dnam_ex_3cpg_cat_gen.ffData</span></span>
<span><span class="va">dnam_ex_3cpgs_cat</span></span>
<span><span class="co">#&gt; This is categorical environmental data read in by 'envDataRead'</span></span>
<span><span class="co">#&gt; with 1 columns</span></span>
<span><span class="co">#&gt; and 200 rows.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">dnam_ex_3cpgs_cat</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "env.cat"  "env.data"</span></span>
<span><span class="fu"><a href="../reference/showRaw.html">showRaw</a></span><span class="op">(</span><span class="va">dnam_ex_3cpgs_cat</span><span class="op">)</span></span>
<span><span class="co">#&gt; opening ff /tmp/RtmpVechPi/ff/ff52eeccd64809.ff</span></span>
<span><span class="co">#&gt;     [,1]</span></span>
<span><span class="co">#&gt; id1 2   </span></span>
<span><span class="co">#&gt; id2 2   </span></span>
<span><span class="co">#&gt; id3 3   </span></span>
<span><span class="co">#&gt; id4 2   </span></span>
<span><span class="co">#&gt; id5 1   </span></span>
<span><span class="co">#&gt; attr(,"vmode")</span></span>
<span><span class="co">#&gt; [1] byte</span></span>
<span><span class="co">#&gt; Levels: 1 2 3</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Julia Romanowska, Haakon K. Gjessing.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
