<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prepare data • HaplinMethyl</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Prepare data">
<meta property="og:description" content="HaplinMethyl">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HaplinMethyl</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jromanowska/HaplinMethyl">
    <span class="glyphicon glyphicon-download"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Prepare_data_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Prepare data</h1>
                        <h4 class="author">Julia Romanowska</h4>
            
            <h4 class="date">2021-06-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jromanowska/HaplinMethyl/blob/master/vignettes/Prepare_data.Rmd"><code>vignettes/Prepare_data.Rmd</code></a></small>
      <div class="hidden name"><code>Prepare_data.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette will show you how to prepare the DNA methylation dataset that you have read into the memory as shown in <code>Read data</code> vignette. The preparation is necessary to use this methylation data together with genetic data in interaction analyses in <a href="https://cran.r-project.org/package=Haplin"><code>Haplin</code> package</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jromanowska/HaplinMethyl/">HaplinMethyl</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: Haplin</span>

<span class="va">ex_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"HaplinMethyl"</span><span class="op">)</span>
<span class="va">ex_file</span> <span class="op">&lt;-</span> <span class="st">"env_data_test.dat"</span>
<span class="va">ex_out_file</span> <span class="op">&lt;-</span> <span class="st">"dnam_ex"</span>

<span class="va">dnam_ex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/envDataRead.html">envDataRead</a></span><span class="op">(</span>
  file.in <span class="op">=</span> <span class="va">ex_file</span>,
  dir.in <span class="op">=</span> <span class="va">ex_path</span>,
  file.out <span class="op">=</span> <span class="va">ex_out_file</span>,
  sep <span class="op">=</span> <span class="st">" "</span>,
  overwrite <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
<span class="co">#&gt; Reading the data in chunks...</span>
<span class="co">#&gt;  -- chunk 1--</span>
<span class="co">#&gt;  -- chunk 2--</span>
<span class="co">#&gt; ... done reading.</span>
<span class="co">#&gt; Preparing data...</span>
<span class="co">#&gt; ... done preparing</span>
<span class="co">#&gt; Saving data...</span>
<span class="co">#&gt; ... saved to file: ./dnam_ex_env.ffData</span></code></pre></div>
</div>
<div id="subsetting" class="section level1">
<h1 class="hasAnchor">
<a href="#subsetting" class="anchor"></a>Subsetting</h1>
<p>Let’s check again what does <code>dnam_ex</code> object include:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dnam_ex</span>
<span class="co">#&gt; This is continuous environmental data read in by 'envDataRead'</span>
<span class="co">#&gt; with 400 columns</span>
<span class="co">#&gt; and 200 rows.</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dnam_ex</span><span class="op">)</span>
<span class="co">#&gt; List of 5</span>
<span class="co">#&gt;  $ class   : chr [1:2] "env.cont" "env.data"</span>
<span class="co">#&gt;  $ nrow    : int 200</span>
<span class="co">#&gt;  $ ncol    : int 400</span>
<span class="co">#&gt;  $ rownames: chr [1:200] "id1" "id2" "id3" "id4" ...</span>
<span class="co">#&gt;  $ colnames: chr [1:400] "cg1" "cg2" "cg3" "cg4" ...</span></code></pre></div>
<p>When you don’t want to use the entire data, you can use <code>envDataSubset</code> function to easily specify which filters to apply to the dataset.</p>
<p>You can subset using row names, row numbers, column names, or column numbers. This is useful when you want to, e.g., extract only the measurements from one subgroup of samples or focus on specific CpGs.</p>
<blockquote>
<p>Check the <code>Finding CpGs</code> vignette on how to use the functions that find CpGs within a defined region!</p>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dnam_ex_3cpgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/envDataSubset.html">envDataSubset</a></span><span class="op">(</span>
  env.data <span class="op">=</span> <span class="va">dnam_ex</span>,
  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cg5"</span>, <span class="st">"cg7"</span>, <span class="st">"cg10"</span><span class="op">)</span>,
  file.out <span class="op">=</span> <span class="st">"dnam_ex_3cpgs"</span>
<span class="op">)</span>
<span class="co">#&gt; Will select 3 columns.</span>
<span class="co">#&gt; opening ff /tmp/RtmpjWSMTn/ff/ff444947221a10.ff</span>
<span class="co">#&gt; Saving data... </span>
<span class="co">#&gt; ... saved to files: ./dnam_ex_3cpgs_gen.ffData, ./dnam_ex_3cpgs_gen.RData</span></code></pre></div>
<p>This produces two new files: <code>dnam_ex_3cpgs_gen.ffData</code> and <code>dnam_ex_3cpgs_gen.RData</code>, which again can be used to load the data faster in the next R-session instance.</p>
<p>And the returned object is of the same class as the original one, but has only the three chosen CpGs:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dnam_ex_3cpgs</span>
<span class="co">#&gt; This is continuous environmental data read in by 'envDataRead'</span>
<span class="co">#&gt; with 3 columns</span>
<span class="co">#&gt; and 200 rows.</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dnam_ex_3cpgs</span><span class="op">)</span>
<span class="co">#&gt; List of 5</span>
<span class="co">#&gt;  $ class   : chr [1:2] "env.cont" "env.data"</span>
<span class="co">#&gt;  $ nrow    : int 200</span>
<span class="co">#&gt;  $ ncol    : int 3</span>
<span class="co">#&gt;  $ rownames: chr [1:200] "id1" "id2" "id3" "id4" ...</span>
<span class="co">#&gt;  $ colnames: chr [1:3] "cg5" "cg7" "cg10"</span></code></pre></div>
</div>
<div id="categorizing" class="section level1">
<h1 class="hasAnchor">
<a href="#categorizing" class="anchor"></a>Categorizing</h1>
<p>When the measurements are continuous (as it is usually with data from arrays), we need to first categorize it to use in <code>Haplin</code>. Thus, the level of DNA methylation at a single CpG or a CpG region will dictate the stratum membership for each sample.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dnam_ex_3cpgs_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/envDataCategorize.html">envDataCategorize</a></span><span class="op">(</span>
  env.data <span class="op">=</span> <span class="va">dnam_ex_3cpgs</span>,
  breaks <span class="op">=</span> <span class="fl">3</span>,
  file.out <span class="op">=</span> <span class="st">"dnam_ex_3cpg_cat"</span>,
  overwrite <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
<span class="co">#&gt; opening ff /tmp/RtmpjWSMTn/ff/ff44492849aa3.ff</span>
<span class="co">#&gt; Creating categories: 1,2,3</span>
<span class="co">#&gt; Saving data...</span>
<span class="co">#&gt; ... saved to file: ./dnam_ex_3cpg_cat_gen.ffData</span>
<span class="va">dnam_ex_3cpgs_cat</span>
<span class="co">#&gt; This is categorical environmental data read in by 'envDataRead'</span>
<span class="co">#&gt; with 1 columns</span>
<span class="co">#&gt; and 200 rows.</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">dnam_ex_3cpgs_cat</span><span class="op">)</span>
<span class="co">#&gt; [1] "env.cat"  "env.data"</span>
<span class="fu"><a href="../reference/showRaw.html">showRaw</a></span><span class="op">(</span><span class="va">dnam_ex_3cpgs_cat</span><span class="op">)</span>
<span class="co">#&gt; opening ff /tmp/RtmpjWSMTn/ff/ff44493ef19367.ff</span>
<span class="co">#&gt;     [,1]</span>
<span class="co">#&gt; id1 2   </span>
<span class="co">#&gt; id2 2   </span>
<span class="co">#&gt; id3 3   </span>
<span class="co">#&gt; id4 2   </span>
<span class="co">#&gt; id5 1   </span>
<span class="co">#&gt; attr(,"vmode")</span>
<span class="co">#&gt; [1] byte</span>
<span class="co">#&gt; Levels: 1 2 3</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Julia Romanowska, Haakon K. Gjessing.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
